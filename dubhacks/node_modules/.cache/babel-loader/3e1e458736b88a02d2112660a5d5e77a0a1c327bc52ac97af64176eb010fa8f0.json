{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{userService}from'../../services/userService';import{useAuth}from'../../contexts/AuthContext';import{EventCard}from'../search/EventCard';import'./UserComponents.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const SavedEvents=_ref=>{let{onEventUnsave,onCalendarAdd}=_ref;const{state}=useAuth();const{user}=state;const[savedEvents,setSavedEvents]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[searchTerm,setSearchTerm]=useState('');const[sortBy,setSortBy]=useState('date');const[filterCategory,setFilterCategory]=useState('');const loadSavedEvents=useCallback(async()=>{if(!(user!==null&&user!==void 0&&user.userId))return;try{setLoading(true);setError(null);const events=await userService.getSavedEvents(user.userId);setSavedEvents(events);}catch(err){setError(err instanceof Error?err.message:'Failed to load saved events');}finally{setLoading(false);}},[user===null||user===void 0?void 0:user.userId]);useEffect(()=>{if(user!==null&&user!==void 0&&user.userId){loadSavedEvents();}},[user===null||user===void 0?void 0:user.userId,loadSavedEvents]);const handleUnsaveEvent=async eventId=>{if(!(user!==null&&user!==void 0&&user.userId))return;try{await userService.unsaveEvent(user.userId,eventId);setSavedEvents(prev=>prev.filter(event=>event.eventId!==eventId));if(onEventUnsave){onEventUnsave(eventId);}}catch(err){setError(err instanceof Error?err.message:'Failed to remove event');}};const handleCalendarAdd=event=>{if(onCalendarAdd){onCalendarAdd(event);}};// Get unique categories for filter dropdown\nconst categories=Array.from(new Set(savedEvents.map(event=>event.category))).sort();// Filter and sort events\nconst filteredAndSortedEvents=savedEvents.filter(event=>{const matchesSearch=searchTerm===''||event.title.toLowerCase().includes(searchTerm.toLowerCase())||event.description.toLowerCase().includes(searchTerm.toLowerCase())||event.tags.some(tag=>tag.toLowerCase().includes(searchTerm.toLowerCase()));const matchesCategory=filterCategory===''||event.category===filterCategory;return matchesSearch&&matchesCategory;}).sort((a,b)=>{switch(sortBy){case'date':return a.startDateTime.getTime()-b.startDateTime.getTime();case'title':return a.title.localeCompare(b.title);case'category':return a.category.localeCompare(b.category);default:return 0;}});if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"saved-events\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\",children:\"Loading saved events...\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"saved-events\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"saved-events-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Saved Events\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"events-count\",children:[savedEvents.length,\" event\",savedEvents.length!==1?'s':'',\" saved\"]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),savedEvents.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCC5\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Saved Events\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You haven't saved any events yet. Start exploring events and save the ones you're interested in!\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"saved-events-controls\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-control\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search saved events...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-controls\",children:[/*#__PURE__*/_jsxs(\"select\",{value:filterCategory,onChange:e=>setFilterCategory(e.target.value),className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Categories\"}),categories.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category,children:category},category))]}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:\"sort-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"date\",children:\"Sort by Date\"}),/*#__PURE__*/_jsx(\"option\",{value:\"title\",children:\"Sort by Title\"}),/*#__PURE__*/_jsx(\"option\",{value:\"category\",children:\"Sort by Category\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"saved-events-list\",children:filteredAndSortedEvents.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No events match your search criteria.\"})}):filteredAndSortedEvents.map(event=>{var _event$source;// Convert Event to SearchEvent for EventCard compatibility\nconst searchEvent={eventId:event.eventId,title:event.title,description:event.description,startDateTime:event.startDateTime.toISOString(),endDateTime:event.endDateTime.toISOString(),location:{venue:event.location.venue,address:event.location.address,city:event.location.city,state:event.location.state},relevanceScore:1.0,// Default high relevance for saved events\nsource:((_event$source=event.source)===null||_event$source===void 0?void 0:_event$source.type)||'user-submitted',isUserSubmitted:!!event.createdBy,isSaved:true};return/*#__PURE__*/_jsxs(\"div\",{className:\"saved-event-item\",children:[/*#__PURE__*/_jsx(EventCard,{event:searchEvent,onSave:()=>handleUnsaveEvent(event.eventId),onCalendarAdd:()=>handleCalendarAdd(event)}),/*#__PURE__*/_jsx(\"div\",{className:\"saved-event-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"unsave-button\",onClick:()=>handleUnsaveEvent(event.eventId),title:\"Remove from saved events\",children:\"Remove\"})})]},event.eventId);})}),/*#__PURE__*/_jsx(\"div\",{className:\"saved-events-stats\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:savedEvents.length}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total Saved\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:categories.length}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Categories\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:savedEvents.filter(event=>event.startDateTime>new Date()).length}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Upcoming\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-value\",children:savedEvents.filter(event=>event.price.isFree).length}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Free Events\"})]})]})})]})]});};export default SavedEvents;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}