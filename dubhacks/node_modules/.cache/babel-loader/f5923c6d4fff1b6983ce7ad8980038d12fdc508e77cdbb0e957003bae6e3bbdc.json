{"ast":null,"code":"import _objectSpread from\"/Users/rishivora/Documents/Coding/Hackathons/dubhacks-au25/dubhacks/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import{userService}from'../../services/userService';import{useAuth}from'../../contexts/AuthContext';import'./UserComponents.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const eventCategories=['Music','Sports','Technology','Business','Arts & Culture','Food & Drink','Health & Wellness','Education','Community','Entertainment','Networking','Outdoor','Family','Fashion','Gaming','Travel','Charity','Religion','Politics','Other'];const UserPreferences=_ref=>{var _formData$priceRange,_formData$priceRange2,_formData$priceRange3,_formData$notificatio,_formData$notificatio2,_formData$notificatio3,_formData$notificatio4,_formData$notificatio5;let{onPreferencesUpdate}=_ref;const{state}=useAuth();const{user}=state;const[preferences,setPreferences]=useState(null);const[isEditing,setIsEditing]=useState(false);const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[error,setError]=useState(null);const[formData,setFormData]=useState({});const loadPreferences=useCallback(async()=>{if(!(user!==null&&user!==void 0&&user.userId))return;try{setLoading(true);setError(null);const preferencesData=await userService.getUserPreferences(user.userId);setPreferences(preferencesData);setFormData(preferencesData);}catch(err){setError(err instanceof Error?err.message:'Failed to load preferences');}finally{setLoading(false);}},[user===null||user===void 0?void 0:user.userId]);useEffect(()=>{if(user!==null&&user!==void 0&&user.userId){loadPreferences();}},[user===null||user===void 0?void 0:user.userId,loadPreferences]);const handleEdit=()=>{setIsEditing(true);setFormData(preferences||{});};const handleCancel=()=>{setIsEditing(false);setFormData(preferences||{});setError(null);};const handleSave=async()=>{if(!(user!==null&&user!==void 0&&user.userId)||!formData)return;try{setSaving(true);setError(null);const updatedPreferences=await userService.updateUserPreferences(user.userId,formData);setPreferences(updatedPreferences);setIsEditing(false);if(onPreferencesUpdate){onPreferencesUpdate(updatedPreferences);}}catch(err){setError(err instanceof Error?err.message:'Failed to update preferences');}finally{setSaving(false);}};const handleCategoryToggle=category=>{const currentCategories=formData.eventCategories||[];const updatedCategories=currentCategories.includes(category)?currentCategories.filter(c=>c!==category):[...currentCategories,category];setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{eventCategories:updatedCategories}));};const handlePriceRangeChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{priceRange:_objectSpread(_objectSpread({},prev.priceRange),{},{[field]:field==='currency'?value:Number(value)})}));};const handleNotificationChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{notificationSettings:_objectSpread(_objectSpread({},prev.notificationSettings),{},{[field]:value})}));};const handleMaxDistanceChange=value=>{const numValue=Number(value);if(!isNaN(numValue)&&numValue>=0){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{maxDistance:numValue}));}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"user-preferences\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\",children:\"Loading preferences...\"})});}if(!preferences){return/*#__PURE__*/_jsx(\"div\",{className:\"user-preferences\",children:/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:\"Preferences not found\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"user-preferences\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"preferences-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Preferences\"}),!isEditing&&/*#__PURE__*/_jsx(\"button\",{className:\"edit-button\",onClick:handleEdit,children:\"Edit Preferences\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"preferences-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"preferences-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Event Categories\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-description\",children:\"Select the types of events you're interested in to get personalized recommendations.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"categories-grid\",children:eventCategories.map(category=>/*#__PURE__*/_jsxs(\"label\",{className:\"category-checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:(formData.eventCategories||[]).includes(category),onChange:()=>handleCategoryToggle(category),disabled:!isEditing}),/*#__PURE__*/_jsx(\"span\",{className:\"category-label\",children:category})]},category))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"preferences-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Location Preferences\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Maximum Distance (miles)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"field-description\",children:\"How far are you willing to travel for events?\"}),isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",max:\"500\",value:formData.maxDistance||'',onChange:e=>handleMaxDistanceChange(e.target.value),placeholder:\"Enter maximum distance\"}):/*#__PURE__*/_jsxs(\"span\",{className:\"preference-value\",children:[preferences.maxDistance,\" miles\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"preferences-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Price Range\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-description\",children:\"Set your preferred price range for events.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Minimum Price\"}),isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:((_formData$priceRange=formData.priceRange)===null||_formData$priceRange===void 0?void 0:_formData$priceRange.min)||'',onChange:e=>handlePriceRangeChange('min',e.target.value),placeholder:\"Min price\"}):/*#__PURE__*/_jsxs(\"span\",{className:\"preference-value\",children:[\"$\",preferences.priceRange.min,\" \",preferences.priceRange.currency]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Maximum Price\"}),isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:((_formData$priceRange2=formData.priceRange)===null||_formData$priceRange2===void 0?void 0:_formData$priceRange2.max)||'',onChange:e=>handlePriceRangeChange('max',e.target.value),placeholder:\"Max price\"}):/*#__PURE__*/_jsxs(\"span\",{className:\"preference-value\",children:[\"$\",preferences.priceRange.max,\" \",preferences.priceRange.currency]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Currency\"}),isEditing?/*#__PURE__*/_jsxs(\"select\",{value:((_formData$priceRange3=formData.priceRange)===null||_formData$priceRange3===void 0?void 0:_formData$priceRange3.currency)||'USD',onChange:e=>handlePriceRangeChange('currency',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"USD\",children:\"USD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"EUR\",children:\"EUR\"}),/*#__PURE__*/_jsx(\"option\",{value:\"GBP\",children:\"GBP\"}),/*#__PURE__*/_jsx(\"option\",{value:\"CAD\",children:\"CAD\"})]}):/*#__PURE__*/_jsx(\"span\",{className:\"preference-value\",children:preferences.priceRange.currency})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"preferences-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Notification Settings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-description\",children:\"Choose how you'd like to be notified about events and updates.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:(_formData$notificatio=(_formData$notificatio2=formData.notificationSettings)===null||_formData$notificatio2===void 0?void 0:_formData$notificatio2.emailNotifications)!==null&&_formData$notificatio!==void 0?_formData$notificatio:false,onChange:e=>handleNotificationChange('emailNotifications',e.target.checked),disabled:!isEditing}),/*#__PURE__*/_jsx(\"span\",{children:\"Email Notifications\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"field-description\",children:\"Receive email updates about new events and recommendations.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:(_formData$notificatio3=(_formData$notificatio4=formData.notificationSettings)===null||_formData$notificatio4===void 0?void 0:_formData$notificatio4.pushNotifications)!==null&&_formData$notificatio3!==void 0?_formData$notificatio3:false,onChange:e=>handleNotificationChange('pushNotifications',e.target.checked),disabled:!isEditing}),/*#__PURE__*/_jsx(\"span\",{children:\"Push Notifications\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"field-description\",children:\"Receive push notifications on your device.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Event Reminder Time\"}),/*#__PURE__*/_jsx(\"p\",{className:\"field-description\",children:\"How many minutes before an event would you like to be reminded?\"}),isEditing?/*#__PURE__*/_jsxs(\"select\",{value:((_formData$notificatio5=formData.notificationSettings)===null||_formData$notificatio5===void 0?void 0:_formData$notificatio5.reminderTime)||60,onChange:e=>handleNotificationChange('reminderTime',Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:15,children:\"15 minutes\"}),/*#__PURE__*/_jsx(\"option\",{value:30,children:\"30 minutes\"}),/*#__PURE__*/_jsx(\"option\",{value:60,children:\"1 hour\"}),/*#__PURE__*/_jsx(\"option\",{value:120,children:\"2 hours\"}),/*#__PURE__*/_jsx(\"option\",{value:1440,children:\"1 day\"}),/*#__PURE__*/_jsx(\"option\",{value:2880,children:\"2 days\"}),/*#__PURE__*/_jsx(\"option\",{value:10080,children:\"1 week\"})]}):/*#__PURE__*/_jsx(\"span\",{className:\"preference-value\",children:preferences.notificationSettings.reminderTime>=1440?\"\".concat(Math.floor(preferences.notificationSettings.reminderTime/1440),\" day(s)\"):preferences.notificationSettings.reminderTime>=60?\"\".concat(Math.floor(preferences.notificationSettings.reminderTime/60),\" hour(s)\"):\"\".concat(preferences.notificationSettings.reminderTime,\" minutes\")})]})]}),isEditing&&/*#__PURE__*/_jsxs(\"div\",{className:\"preferences-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-button\",onClick:handleSave,disabled:saving,children:saving?'Saving...':'Save Preferences'}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-button\",onClick:handleCancel,disabled:saving,children:\"Cancel\"})]})]})]});};export default UserPreferences;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}